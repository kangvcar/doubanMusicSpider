# è±†ç“£éŸ³ä¹çˆ¬è™«é¡¹ç›®

## é¡¹ç›®æè¿°
è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºScrapyæ¡†æ¶çš„è±†ç“£éŸ³ä¹çˆ¬è™«ï¼Œç”¨äºçˆ¬å–è±†ç“£éŸ³ä¹TOP250çš„éŸ³ä¹ä¿¡æ¯ä»¥åŠè¿™äº›éŸ³ä¹çš„è¯„è®ºä¿¡æ¯ã€‚çˆ¬è™«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š

1. **è±†ç“£éŸ³ä¹ä¿¡æ¯çˆ¬è™« (`douban_music_spider`)**: çˆ¬å–è±†ç“£éŸ³ä¹TOP250çš„éŸ³ä¹çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶ä¿å­˜åˆ°`output/music_info.csv`æ–‡ä»¶ä¸­ã€‚åŒæ—¶ï¼Œå°†éŸ³ä¹çš„IDä¿å­˜åˆ°`output/music_ids.txt`æ–‡ä»¶ä¸­ã€‚
2. **è±†ç“£éŸ³ä¹è¯„è®ºçˆ¬è™« (`douban_music_comment`)**: æ ¹æ®éŸ³ä¹IDçˆ¬å–å¯¹åº”éŸ³ä¹çš„æ‰€æœ‰è¯„è®ºä¿¡æ¯ï¼Œå¹¶ä¿å­˜åˆ°`output/music_comments.csv`æ–‡ä»¶ä¸­ã€‚

## ç¯å¢ƒè¦æ±‚

- Python 3.6+
- Scrapy 2.0+

## é¡¹ç›®ç»“æ„
```
douban_music/
â”‚   scrapy.cfg
â”‚   README.md
â”‚   requirements.txt
â”‚
â”œâ”€â”€â”€douban_music/
â”‚   â”‚   items.py
â”‚   â”‚   middlewares.py
â”‚   â”‚   pipelines.py
â”‚   â”‚   settings.py
â”‚   â”‚   __init__.py
â”‚   â”‚
â”‚   â””â”€â”€â”€spiders/
â”‚           douban_music_comment_spider.py
â”‚           douban_music_spider.py
â”‚           __init__.py
â”‚
â””â”€â”€â”€output/
        music_comments.csv
        music_ids.txt
        music_info.csv
```

## å¦‚ä½•ä½¿ç”¨

### å®‰è£…ä¾èµ–
é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº†Pythonå’ŒScrapyã€‚ç„¶åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…æ‰€éœ€çš„ä¾èµ–ï¼š

```bash
pip install -r requirements.txt
```

### è¿è¡Œçˆ¬è™«

1. è¿è¡Œè±†ç“£éŸ³ä¹ä¿¡æ¯çˆ¬è™«ï¼š

```bash
scrapy crawl douban_music_spider
```

è¯¥å‘½ä»¤ä¼šçˆ¬å–è±†ç“£éŸ³ä¹TOP250çš„éŸ³ä¹ä¿¡æ¯ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°`output/music_info.csv`æ–‡ä»¶ä¸­ã€‚åŒæ—¶ï¼ŒéŸ³ä¹çš„IDä¼šè¢«ä¿å­˜åˆ°`output/music_ids.txt`æ–‡ä»¶ä¸­ã€‚

2. è¿è¡Œè±†ç“£éŸ³ä¹è¯„è®ºçˆ¬è™«ï¼š

```bash
scrapy crawl douban_music_comment
```

è¯¥å‘½ä»¤ä¼šæ ¹æ®`output/music_ids.txt`æ–‡ä»¶ä¸­çš„éŸ³ä¹IDï¼Œçˆ¬å–è¿™äº›éŸ³ä¹çš„æ‰€æœ‰è¯„è®ºä¿¡æ¯ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°`output/music_comments.csv`æ–‡ä»¶ä¸­ã€‚

## è¾“å‡ºæ–‡ä»¶è¯´æ˜

- `music_info.csv`: ä¿å­˜äº†è±†ç“£éŸ³ä¹TOP250çš„éŸ³ä¹åŸºæœ¬ä¿¡æ¯ã€‚åŒ…å«çš„å­—æ®µæœ‰ï¼š
  - `title`: éŸ³ä¹æ ‡é¢˜
  - `performer`: æ¼”å‡ºè€…
  - `release_date`: å‘è¡Œæ—¥æœŸ
  - `album_type`: ä¸“è¾‘ç±»å‹
  - `medium`: åª’ä»‹
  - `genre`: æµæ´¾
  - `rating`: è¯„åˆ†
  - `rating_count`: è¯„åˆ†äººæ•°
  - `cover_link`: å°é¢é“¾æ¥
  - `music_id`: éŸ³ä¹ID

- `music_ids.txt`: ä¿å­˜äº†è±†ç“£éŸ³ä¹TOP250çš„éŸ³ä¹IDã€‚

- `music_comments.csv`: ä¿å­˜äº†æ ¹æ®éŸ³ä¹IDçˆ¬å–çš„æ‰€æœ‰è¯„è®ºä¿¡æ¯ã€‚åŒ…å«çš„å­—æ®µæœ‰ï¼š
  - `username`: ç”¨æˆ·å
  - `rating`: è¯„åˆ†
  - `comment_time`: è¯„è®ºæ—¶é—´
  - `useful_count`: æœ‰ç”¨æ•°é‡
  - `content`: è¯„è®ºå†…å®¹
  - `music_title`: éŸ³ä¹æ ‡é¢˜

## æ³¨æ„äº‹é¡¹

- è¯·éµå®ˆè±†ç“£çš„çˆ¬è™«ä½¿ç”¨åè®®ï¼Œä¸è¦å¯¹è±†ç“£çš„æœåŠ¡å™¨é€ æˆè¿‡å¤§çš„å‹åŠ›ã€‚
- è¯·ç¡®ä¿åœ¨è¿è¡Œçˆ¬è™«å‰ï¼Œä½ æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´æ¥ä¿å­˜çˆ¬å–çš„æ•°æ®ã€‚
- é¡¹ç›®ä¸­çš„ä»£ç ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç›®çš„ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚

---

ğŸ‰ ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ ğŸ‰